<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1648px" height="1159px" viewBox="-0.5 -0.5 1648 1159" content="&lt;mxfile&gt;&lt;diagram id=&quot;a9Ih5XxseeB6gsodpl9r&quot; name=&quot;第 1 页&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><rect x="0" y="0" width="1647" height="1158" fill="#ffffff" stroke="none" pointer-events="all"/><path d="M 1062 200 L 1062 273.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1062 278.88 L 1058.5 271.88 L 1062 273.63 L 1065.5 271.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="947" y="120" width="230" height="80" rx="12" ry="12" fill="#66b2ff" stroke="#66b2ff" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 228px; height: 1px; padding-top: 160px; margin-left: 948px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p class="MsoNormal"><span style="font-size: 10.5000pt"><font face="Calibri" color="#000000">1. rproc_inst 初始化</font></span></p></div></div></div></foreignObject><text x="1062" y="164" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">1. rproc_inst 初始化</text></switch></g><rect x="1227" y="120" width="230" height="100" rx="15" ry="15" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 228px; height: 1px; padding-top: 170px; margin-left: 1228px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p class="MsoNormal"><font face="Calibri"><span style="font-size: 14px;">1. 初始化rsc_table,并且纳入mems</span></font></p><p class="MsoNormal"><font face="Calibri"><span style="font-size: 14px">2. 将</span></font><span style="font-family: &quot;calibri&quot; ; font-size: 10.5pt">vring[0].da 的地址纳入mems</span></p><p class="MsoNormal"><span style="font-family: calibri; font-size: 10.5pt;">3. 将</span><span style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px;">kick_device 关联至</span><span style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px;">rproc-&gt;priv</span></p></div></div></div></foreignObject><text x="1342" y="174" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">1. 初始化rsc_table,并且纳入mems...</text></switch></g><path d="M 1227 170 L 1177 170" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1062 350 L 1062 403.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1062 408.88 L 1058.5 401.88 L 1062 403.63 L 1065.5 401.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="947" y="280" width="230" height="70" rx="10.5" ry="10.5" fill="#66b2ff" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 228px; height: 1px; padding-top: 315px; margin-left: 948px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p class="MsoNormal"><span style="font-size: 10.5pt;"><font color="#000000" style=""><font face="consolas, courier new, monospace" style="">2. 初始化</font><font face="Calibri" style="">sharebuf</font></font></span></p></div></div></div></foreignObject><text x="1062" y="319" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">2. 初始化sharebuf</text></switch></g><path d="M 1062 480 L 1062 543.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1062 548.88 L 1058.5 541.88 L 1062 543.63 L 1065.5 541.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="947" y="410" width="230" height="70" rx="10.5" ry="10.5" fill="#66b2ff" stroke="#66b2ff" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 228px; height: 1px; padding-top: 445px; margin-left: 948px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#000000" style=""><span style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px;">3. 初始化virtio_device</span><br />中的配置信息</font></div></div></div></foreignObject><text x="1062" y="449" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">3. 初始化virtio_device...</text></switch></g><rect x="1227" y="250" width="230" height="100" rx="15" ry="15" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 228px; height: 1px; padding-top: 300px; margin-left: 1228px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p class="MsoNormal"><font face="Calibri"><span style="font-size: 14px">1. 如果采用linux kernel  通信方式，sharebuf 由linux 进行定义</span></font></p></div></div></div></foreignObject><text x="1342" y="304" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">1. 如果采用linux kernel  通信方式，sharebuf 由linux 进行定义</text></switch></g><rect x="1227" y="375" width="260" height="185" rx="27.75" ry="27.75" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 258px; height: 1px; padding-top: 468px; margin-left: 1228px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p class="MsoNormal"><font face="Calibri" style=""><span style="font-size: 14px;">1.  使用资源表中的</span></font><span style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px;">rpmsg_vdev初始化vdev</span></p><p class="MsoNormal"><span style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px;">2. 将rpmsg_vdev 与</span><span style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px;">rpvdev 进行管理</span></p><p class="MsoNormal"><span style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px;">3. 由于master 与 slave 同时操作同一个share_table ,主机优先进行vdev 中vring_info 的初始化（原因是，从机如果完成整个资源的初始化后，会发送ns 消息，有可能主机没有准备好，从机后续使用住的分配好的资源）</span></p></div></div></div></foreignObject><text x="1357" y="471" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">1.  使用资源表中的rpmsg_vdev初始化vdev...</text></switch></g><path d="M 1062 610 L 1062 643.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1062 648.88 L 1058.5 641.88 L 1062 643.63 L 1065.5 641.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="947" y="550" width="230" height="60" rx="9" ry="9" fill="#66b2ff" stroke="#66b2ff" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 228px; height: 1px; padding-top: 580px; margin-left: 948px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#000000" style=""><span style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px;">4. 初始化</span><span style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px;">shpool</span></font></div></div></div></foreignObject><text x="1062" y="584" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">4. 初始化shpool</text></switch></g><rect x="1227" y="585" width="260" height="120" rx="18" ry="18" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 258px; height: 1px; padding-top: 645px; margin-left: 1228px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p class="MsoNormal"><font face="Calibri"><span style="font-size: 14px">初始化与amp core 约定好的内存空间，使用</span></font><span style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px;">struct</span><span style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px;"> rpmsg_virtio_shm_pool * 进行管理</span></p></div></div></div></foreignObject><text x="1357" y="649" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">初始化与amp core 约定好的内存空间，使用struct rpmsg_virtio_shm_pool * 进行管理</text></switch></g><path d="M 1062 700 L 1062 743.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1062 748.88 L 1058.5 741.88 L 1062 743.63 L 1065.5 741.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="947" y="650" width="230" height="50" rx="7.5" ry="7.5" fill="#66b2ff" stroke="#66b2ff" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 228px; height: 1px; padding-top: 675px; margin-left: 948px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#000000">5. 初始化vring 中的buffer</font></div></div></div></foreignObject><text x="1062" y="679" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">5. 初始化vring 中的buffer</text></switch></g><rect x="1227" y="740" width="260" height="90" rx="13.5" ry="13.5" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 258px; height: 1px; padding-top: 785px; margin-left: 1228px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p class="MsoNormal"><font face="Calibri"><span style="font-size: 14px;">仅主机分配rvq 的buffer资源，存放至</span></font></p><div style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px; line-height: 19px;">vq-&gt;vq_ring.desc 中</div></div></div></div></foreignObject><text x="1357" y="789" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">仅主机分配rvq 的buffer资源，存放至...</text></switch></g><path d="M 1062 810 L 1062 853.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1062 858.88 L 1058.5 851.88 L 1062 853.63 L 1065.5 851.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="947" y="750" width="230" height="60" rx="9" ry="9" fill="#66b2ff" stroke="#66b2ff" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 228px; height: 1px; padding-top: 780px; margin-left: 948px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#000000">6. 初始化NS endpoint</font></div></div></div></foreignObject><text x="1062" y="784" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">6. 初始化NS endpoint</text></switch></g><rect x="1227" y="870" width="260" height="120" rx="18" ry="18" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 258px; height: 1px; padding-top: 930px; margin-left: 1228px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><p class="MsoNormal"><font face="Calibri" style=""><span style="font-size: 14px;">主机置位 </span></font><span style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px;">VIRTIO_CONFIG_STATUS_DRIVER_OK</span></p><p class="MsoNormal"><span style="font-family: consolas, &quot;courier new&quot;, monospace; font-size: 14px;">允许从机继续3 流程</span></p></div></div></div></foreignObject><text x="1357" y="934" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">主机置位 VIRTIO_CONFIG_STATUS_DRIVER_OK...</text></switch></g><path d="M 1062 910 L 1062 953.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1062 958.88 L 1058.5 951.88 L 1062 953.63 L 1065.5 951.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="947" y="860" width="230" height="50" rx="7.5" ry="7.5" fill="#66b2ff" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 228px; height: 1px; padding-top: 885px; margin-left: 948px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#000000">7. 开发者自定义endpoint</font></div></div></div></foreignObject><text x="1062" y="889" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">7. 开发者自定义endpoint</text></switch></g><path d="M 1062 1020 L 1062 1053.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1062 1058.88 L 1058.5 1051.88 L 1062 1053.63 L 1065.5 1051.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="947" y="960" width="230" height="60" rx="9" ry="9" fill="#66b2ff" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 228px; height: 1px; padding-top: 990px; margin-left: 948px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#000000">8. 轮询vq 数据包，并且将其路由至不同endpoint</font></div></div></div></foreignObject><text x="1062" y="994" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">8. 轮询vq 数据包，并且将其路由至不同endpoint</text></switch></g><rect x="947" y="1060" width="230" height="90" rx="13.5" ry="13.5" fill="#66b2ff" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 228px; height: 1px; padding-top: 1105px; margin-left: 948px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#000000">9. 释放资源</font></div></div></div></foreignObject><text x="1062" y="1109" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="middle">9. 释放资源</text></switch></g><path d="M 187 132.5 L 240.77 121.3" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 245.91 120.23 L 239.77 125.08 L 240.77 121.3 L 238.34 118.23 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 187 217.5 L 240.77 228.7" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 245.91 229.77 L 238.34 231.77 L 240.77 228.7 L 239.77 224.92 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="7" y="90" width="180" height="170" rx="10.2" ry="10.2" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 178px; height: 1px; padding-top: 175px; margin-left: 8px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="color: rgb(212, 212, 212); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><span style="color: rgb(200, 200, 200); background-color: rgb(30, 30, 30);">1.</span></div><div style="color: rgb(212, 212, 212); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><span style="color: rgb(200, 200, 200); background-color: rgb(30, 30, 30);">platform_init()</span></div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><font color="#c8c8c8" style="background-color: rgb(30, 30, 30);">初始化得到实例：</font></div><div style="color: rgb(212, 212, 212); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><div style="line-height: 19px;"><span style="background-color: rgb(30, 30, 30);"><span style="color: rgb(78, 201, 176);">remoteproc </span>*<span style="color: rgb(200, 200, 200);">rproc</span></span></div></div></div></div></div></foreignObject><text x="97" y="179" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">1....</text></switch></g><rect x="247" y="90" width="310" height="60" rx="9" ry="9" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 308px; height: 1px; padding-top: 120px; margin-left: 248px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><div style="line-height: 19px;">/* Initialize HW system components */</div><div style="line-height: 19px;">init_system();</div></div></div></div></div></foreignObject><text x="402" y="124" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">/* Initialize HW system components */...</text></switch></g><rect x="567" y="90" width="220" height="60" rx="9" ry="9" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 120px; margin-left: 568px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#d4d4d4" style="background-color: rgb(30, 30, 30);">初始化libmetal</font></div></div></div></foreignObject><text x="677" y="124" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">初始化libmetal</text></switch></g><path d="M 557 230 L 560.63 230" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 565.88 230 L 558.88 233.5 L 560.63 230 L 558.88 226.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 402 260 L 402 273.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 402 278.88 L 398.5 271.88 L 402 273.63 L 405.5 271.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="247" y="200" width="310" height="60" rx="9" ry="9" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 308px; height: 1px; padding-top: 230px; margin-left: 248px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><span style="color: #c8c8c8;">platform_create_proc</span>(<span style="color: #c8c8c8;">proc_id</span>, <span style="color: #c8c8c8;">rsc_id</span>);</div></div></div></div></foreignObject><text x="402" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">platform_create_proc(proc_id, rsc_id);</text></switch></g><path d="M 787 230 L 941.17 162.55" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 945.98 160.45 L 940.97 166.46 L 941.17 162.55 L 938.16 160.05 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="567" y="200" width="220" height="60" rx="9" ry="9" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 230px; margin-left: 568px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#d4d4d4" style="background-color: rgb(30, 30, 30);">创建远程处理器实例，传入远程处理器ID和分配给远程处理器使用的资源表</font></div></div></div></foreignObject><text x="677" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">创建远程处理器实例，传入远程处理器ID和分配给远程处理器使用的资源表</text></switch></g><rect x="247" y="20" width="220" height="60" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 50px; margin-left: 248px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font style="font-size: 26px;" color="#ff3333">函数</font></div></div></div></foreignObject><text x="357" y="54" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">函数</text></switch></g><rect x="1130" y="20" width="220" height="60" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 50px; margin-left: 1131px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="font-size: 26px;"><font color="#ff3333">结构体变量</font></span></div></div></div></foreignObject><text x="1240" y="54" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">结构体变量</text></switch></g><rect x="7" y="450" width="220" height="170" rx="8.5" ry="8.5" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 535px; margin-left: 8px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 26px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="color: rgb(212, 212, 212); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><span style="color: rgb(200, 200, 200); background-color: rgb(30, 30, 30);">2.</span></div><div style="color: rgb(212, 212, 212); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><span style="color: rgb(200, 200, 200); background-color: rgb(30, 30, 30);">platform_create_rpmsg_vdev()</span></div><div style="color: rgb(212, 212, 212); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><span style="color: rgb(200, 200, 200); background-color: rgb(30, 30, 30);">创建完成得到实例：</span></div><div style="color: rgb(212, 212, 212); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><div style="line-height: 19px;"><span style="background-color: rgb(30, 30, 30);"><span style="color: rgb(86, 156, 214);">struct</span> <span style="color: rgb(78, 201, 176);">rpmsg_device</span> *<span style="color: rgb(200, 200, 200);">rpdev</span></span></div></div></div></div></div></foreignObject><text x="117" y="543" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="26px" text-anchor="middle">2....</text></switch></g><path d="M 260 595 L 247 595 Q 237 595 237 605 L 237 750 Q 237 760 243.82 760 L 250.63 760" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 255.88 760 L 248.88 763.5 L 250.63 760 L 248.88 756.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="260" y="550" width="470" height="60" rx="9" ry="9" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 468px; height: 1px; padding-top: 580px; margin-left: 261px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 26px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><span style="color: #c8c8c8;">shbuf</span> = <span style="color: #c8c8c8;">metal_io_phys_to_virt</span>(<span style="color: #c8c8c8;">shbuf_io</span>, <span style="color: #bd63c5;">SHARED_MEM_PA</span> + <span style="color: #bd63c5;">SHARED_BUF_OFFSET</span>);</div></div></div></div></foreignObject><text x="495" y="588" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="26px" text-anchor="middle">shbuf = metal_io_phys_to_virt(shbuf_...</text></switch></g><path d="M 260 490 L 247 490 Q 237 490 237 500 L 237 570 Q 237 580 245.32 580 L 253.63 580" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 258.88 580 L 251.88 583.5 L 253.63 580 L 251.88 576.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="260" y="460" width="470" height="60" rx="9" ry="9" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 468px; height: 1px; padding-top: 490px; margin-left: 261px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 26px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><div style="line-height: 19px;"><span style="color: #c8c8c8;">shbuf_io</span> = <span style="color: #c8c8c8;">remoteproc_get_io_with_pa</span>(<span style="color: #c8c8c8;">rproc</span>, <span style="color: #bd63c5;">SHARED_MEM_PA</span>);</div></div></div></div></div></foreignObject><text x="495" y="498" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="26px" text-anchor="middle">shbuf_io = remoteproc_get_io_with_pa...</text></switch></g><rect x="257" y="280" width="290" height="100" rx="15" ry="15" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 288px; height: 1px; padding-top: 330px; margin-left: 258px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 26px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="color: rgb(212, 212, 212); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; background-color: rgb(30, 30, 30);">将libmetal初始化好的bus，io以及共享内存等信息纳入mems，以待后续通过pa、da、va地址调用出来</span></div></div></div></foreignObject><text x="402" y="338" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="26px" text-anchor="middle">将libmetal初始化好的bus，io以及共享内存等信息纳入mems，以待后续通过pa、da、v...</text></switch></g><path d="M 727 670 L 942.55 449.55" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 946.22 445.8 L 943.83 453.25 L 942.55 449.55 L 938.82 448.36 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 260 670 L 217 670 Q 207 670 207 680 L 207 840 Q 207 850 217 850 L 250.63 850" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 255.88 850 L 248.88 853.5 L 250.63 850 L 248.88 846.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 260 655 L 197 655 Q 187 655 186.94 665 L 185.54 893.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 185.51 898.88 L 182.05 891.86 L 185.54 893.63 L 189.05 891.9 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="260" y="640" width="467" height="60" rx="9" ry="9" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 465px; height: 1px; padding-top: 670px; margin-left: 261px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 26px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="background-color: rgb(255, 255, 255); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><div style="color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); line-height: 19px;">vdev = remoteproc_create_virtio(rproc, vdev_index, role, rst_cb);</div></div></div></div></div></foreignObject><text x="494" y="678" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="26px" text-anchor="middle">vdev = remoteproc_create_virtio(rpro...</text></switch></g><path d="M 727 760 L 942.07 584.03" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 946.13 580.71 L 942.93 587.85 L 942.07 584.03 L 938.5 582.43 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 492 790 L 492 813.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 492 818.88 L 488.5 811.88 L 492 813.63 L 495.5 811.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="257" y="730" width="470" height="60" rx="9" ry="9" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 468px; height: 1px; padding-top: 760px; margin-left: 258px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 26px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 14px; line-height: 19px;"><div style="line-height: 19px;"><span style="color: #c8c8c8;">rpmsg_virtio_init_shm_pool</span>(&amp;<span style="color: #c8c8c8;">shpool</span>, <span style="color: #c8c8c8;">shbuf</span>, (<span style="color: #bd63c5;">SHARED_MEM_SIZE</span> - <span style="color: #bd63c5;">SHARED_BUF_OFFSET</span>));</div></div></div></div></div></foreignObject><text x="492" y="768" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="26px" text-anchor="middle">rpmsg_virtio_init_shm_pool(&amp;shpool,...</text></switch></g><path d="M 492 880 L 492 1083.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 492 1088.88 L 488.5 1081.88 L 492 1083.63 L 495.5 1081.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><path d="M 727 850 L 942.02 678.96" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 946.13 675.7 L 942.83 682.79 L 942.02 678.96 L 938.47 677.31 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="257" y="820" width="470" height="60" rx="9" ry="9" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 468px; height: 1px; padding-top: 850px; margin-left: 258px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;"><span style="color: #c8c8c8;">rpmsg_init_vdev</span>(<span style="color: #c8c8c8;">rpmsg_vdev</span>, <span style="color: #c8c8c8;">vdev</span>, <span style="color: #7f7f7f;">ns_bind_cb</span>, <span style="color: #c8c8c8;">shbuf_io</span>, &amp;<span style="color: #c8c8c8;">shpool</span>);</div></div></div></div></foreignObject><text x="492" y="854" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">rpmsg_init_vdev(rpmsg_vdev, vdev, ns_bind_cb, shbuf_io, &amp;shpool);</text></switch></g><path d="M 334 968.58 L 1220.64 930.27" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1225.88 930.05 L 1219.04 933.85 L 1220.64 930.27 L 1218.74 926.85 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="37" y="900" width="297" height="150" rx="22.5" ry="22.5" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 295px; height: 1px; padding-top: 975px; margin-left: 38px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;"><span style="color: #c8c8c8;">函数中会与remote做同步</span></div><div style="color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;"><span style="color: #c8c8c8;">rproc_virtio_wait_remote_ready</span>(<span style="color: #c8c8c8;">vdev</span>);</div></div></div></div></foreignObject><text x="186" y="979" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">函数中会与remote做同步...</text></switch></g><path d="M 247 1120 L 27 1120 Q 17 1120 16.96 1110 L 15.16 626.37" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 15.14 621.12 L 18.67 628.1 L 15.16 626.37 L 11.67 628.13 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="247" y="1090" width="490" height="60" rx="9" ry="9" fill="#1e1e1e" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 488px; height: 1px; padding-top: 1120px; margin-left: 248px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div style="color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px;"><div style="line-height: 19px;"><span style="color: #c8c8c8;">return rpmsg_virtio_get_rpmsg_device</span>(<span style="color: #c8c8c8;">rpmsg_vdev</span>);</div></div></div></div></div></foreignObject><text x="492" y="1124" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="middle">return rpmsg_virtio_get_rpmsg_device(rpmsg_vdev);</text></switch></g><rect x="717" y="0" width="220" height="60" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 218px; height: 1px; padding-top: 30px; margin-left: 718px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><span style="font-size: 26px;"><font color="#ff3333">初始化流程</font></span></div></div></div></foreignObject><text x="827" y="34" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">初始化流程</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>